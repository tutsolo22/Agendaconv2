======================================================================
==                REGISTRO DE AVANCE - PROYECTO AGENDACON v2        ==
======================================================================

Este archivo sirve como un checklist y registro de decisiones para
el desarrollo del proyecto.

---

### FASE 0: CONFIGURACIÓN INICIAL DEL PROYECTO

- [x] Definir la arquitectura del proyecto (ARQUITECTURA_DEL_PROYECTO.txt).
- [x] Crear el archivo de registro de avance (este archivo).
- [x] Instalar Laravel 12 y configurar el entorno de desarrollo.
- [x] Configurar la conexión a la base de datos única en el archivo `.env`.
- [x] Crear la base de datos `agendaconv2_db`.
- [x] Configurar el frontend stack (Vite) con Bootstrap 5 y Font Awesome 6.
- [x] Inicializar el repositorio de Git y realizar el primer commit.
- [x] Instalar paquetes iniciales:
    - [x] `spatie/laravel-permission` (Roles y Permisos)
    - [x] `spatie/laravel-activitylog` (Auditoría)

---

### FASE 1: NÚCLEO DEL SISTEMA Y SUPER-ADMIN (En Progreso)

- [x] Crear archivos de migración para las tablas centrales del sistema:
    - [x] `tenants`
    - [x] `modulos`
    - [x] `users` (con campo para rol, ej: `is_super_admin`)
    - [x] `licencias` (relaciona tenants, modulos, fechas, límites)
    - [x] `licencia_historial`
- [x] Ejecutar las migraciones para crear las tablas centrales en la BD.
- [x] Crear los modelos de Eloquent para las tablas centrales.
- [x] Implementar el sistema de Roles y Permisos de Spatie.
- [x] Crear Seeder para los roles, módulos y datos de prueba.
- [x] Crear el primer usuario Super-Admin (vía Seeder o comando).
- [x] Desarrollar el panel del Super-Admin (rutas, controladores, vistas):
    - [x] Login para Super-Admin.
    - [x] CRUD para Tenants.
    - [x] CRUD para Módulos.
    - [x] CRUD para Licencias (Generador de licencias).

---

### FASE 2: AUTENTICACIÓN Y GESTIÓN DE TENANTS (Completada)

- [x] Implementar el login para usuarios de tenants.
- [x] Crear middleware para validar licencias de módulos.
- [x] Implementar el Global Scope para el aislamiento automático de datos por `tenant_id`.
- [x] Desarrollar el panel del Tenant-Admin:
    - [x] Dashboard básico para Tenant-Admin.
    - [x] Ver información de su licencia y módulos contratados (en la barra de navegación).
    - [x] CRUD para sus propios usuarios (`users` con `tenant_id`).
    - [x] CRUD para sus sucursales (`sucursales` con `tenant_id`).
- [x] Panel de Configuración para el Tenant-Admin.

---

### FASE 3: DESARROLLO DE MÓDULOS (En Progreso)

**Nota Estratégica:** Se comenzará con el módulo de **Facturación CFDI v4**. Aunque es el módulo #3, su funcionalidad es un servicio transversal que será consumido por otros módulos (Citas Médicas, Restaurante, etc.) para emitir facturas. Desarrollarlo primero establece una base de facturación sólida para el resto de la aplicación.

#### Módulo: Facturación CFDI v4
- [x] Crear migraciones para tablas: `facturacion_datos_fiscales`, `facturacion_series_folios`, `facturacion_cfdis`.
- [x] Crear Modelos, Controladores y Vistas para la gestión de facturas (CRUD de Borradores).
- [x] Crear CRUD para la gestión de `DatosFiscales` (CSD).
- [x] Crear CRUD para la gestión de `Series y Folios`.
- [x] Implementar un `FacturacionService` para encapsular la lógica de timbrado (con simulación de PAC).
- [x] Implementar descarga de XML y generación/descarga de PDF para facturas timbradas.
- [x] Implementar la cancelación de CFDI timbrados (con simulación de PAC).
- [x] Implementar el envío de facturas (XML y PDF) por correo electrónico.
- [x] Refactorizar la validación del formulario de creación de facturas a un `FormRequest`.
- [x] Implementar la creación de Notas de Crédito a partir de facturas canceladas.
- [x] Añadir vista de detalle para facturas que muestra los CFDI relacionados.
- [x] Implementar la funcionalidad de Factura Global para ventas al público.
- [ ] Asegurar que todas las consultas y creaciones de registros respeten `tenant_id` y `modulo_id`.

#### Módulo: Citas Médicas (Pendiente)

#### Módulo: Restaurante (Pendiente)

---

### FASE 4 Y POSTERIORES: MÓDULOS ADICIONALES

- [ ] Módulo de Facturación CFDI v4.
- [ ] Módulo de Citas Médicas.
- [ ] Módulo de Reportes y Gráficos.
- [ ] Implementar sistema de Notificaciones con Colas de Trabajo.
- [ ] Implementar sistema de Auditoría en modelos críticos.

---